## はじめに

- tinyurlのようなURL短縮サービスを設計
- ユースケース
    - 長いURLが与えられたらずっと短いURLを返す
    - 短縮URLが与えられたら、元のURLにリダイレクトする
    - 高可用性、スケーラビリティ、フォールトトレランスに対する配慮
        - システムの一部に障害が発生しても、全体としての機能を維持し、サービスを継続できる仕組み

## APIエンドポイント

- URLの短縮をするPOSTリクエスト
- 短いURLから対応する長いURLにリダイレクトするGETリクエスト
- イメージ
    
    ![IMG_7062.jpeg](attachment:c2fbdab8-e20a-403f-be27-05d0a55c730a:IMG_7062.jpeg)
    

### 301リダイレクトと302にリダイレクトの差

- 301は「恒久的」に長いURLに移動されることを示す
    - → 恒久的であるため、ブラウザはレスポンスをキャッシュし、同じURLに対するその後のリクエストはURL短縮サービスに送られることはない
    - サーバー負荷の観点で言えば合理的である
- 302 「一時的に」短いURLに移動することを意味する
    - 同じURLに対するその後のリクエストは、キャッシュされずにURL短縮サービスに送信されてから、長いURLにリダイレクトされる
    - 分析を重視し、クリック率を追跡するのであれば合理的である

## データモデル

- 短いURL, 長いURLのマッピングをリレーショナルデータベースに格納する
- テーブルには、id, 短いURL, 長いURLの3つの列が含まれる

## ハッシュ関数

ハッシュ値は[0-9,na-z, A-z]の62種類の文字からなる。

ハッシュ値の長さを求めるには、62**n ≥ 3650億(本要件) となる最小のnを求めれば良い