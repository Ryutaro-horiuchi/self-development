## ER図  実態関連図

---

- テーブル同士がお互いにどういう関係にあるのか
- 代表的な表記方法は2つある
    - IE表記法
    - IDEFIX(アイデフワンエックス)
        - 割愛

## テーブル同士の関連

---

- 1対1
    - あまり存在しない
        - 二つのテーブルの主キーが一致するケースであるため、一つのテーブルにまとめてしまって問題ないため
- 1対多
    - 最もよくある関連タイプ
    - 厳密には「1対多」と「0または1対多」に分類されるが、一般的にはこれらをまとめて「1対多」と呼ぶことが多い
- 多対多
    - リレーショナルデータベースの「お約束」として、多対多を作成するのではなく、後述する関連実体を用いる

## ER図の書き方

---

### テーブルの表記方法

![IMG_1409.jpeg](https://prod-files-secure.s3.us-west-2.amazonaws.com/42b16988-a5a8-437d-af8b-c8412ee1342b/a64bab53-71ec-40c8-b97c-e897e43a9e8e/bd7cac48-074a-445d-9e08-a13969f58895.png)

- 四角の中を真ん中の線で区切り、主キー属性と非キー属性とに分ける
- 外部キーは、属性名の隣に「FK」と記述する

### IE表記法のER図

![IMG_1410.jpeg](https://prod-files-secure.s3.us-west-2.amazonaws.com/42b16988-a5a8-437d-af8b-c8412ee1342b/eb1802ea-872d-4e13-b688-d60c662c6558/ef228e79-c1a8-45db-844e-5f36ce07c036.png)

- Ex. 「ー」相手のエンティティと対応するレコード数(カーディナリティと呼ぶ)が1であることを示す
- 会社から社員に向けた記号は「0以上の複数」を表す
- 部署から社員に向けた記号は「1以上の複数」を表す

![IMG_1411.jpeg](https://prod-files-secure.s3.us-west-2.amazonaws.com/42b16988-a5a8-437d-af8b-c8412ee1342b/cf78b2d2-14c2-4baf-8a19-289980d58847/5b38c8db-8bfe-4df9-b9a2-15d6e786042c.png)

## 「多対多」と関連実体

- 多対多がRDBの世界だと問題になる
    
    ![IMG_1412.jpeg](https://prod-files-secure.s3.us-west-2.amazonaws.com/42b16988-a5a8-437d-af8b-c8412ee1342b/b658648d-f5e3-4cad-8481-8967879d8e20/e844627d-737e-4d76-b7e4-53a0cb3debde.png)
    
    - 両者のエンティティが共通のキーとなる列を保持できないため、両エンティティを結合することができない
    - 無理やり関連づけようとして学生テーブルに講義コードを持たせても、同じ学生のレコードが複数行含まれるようになってしまうし、講義を登録していない学生テーブルに登録もできなくなってしまう
- 関連実体を作成する
    
    ![IMG_1413.jpeg](https://prod-files-secure.s3.us-west-2.amazonaws.com/42b16988-a5a8-437d-af8b-c8412ee1342b/b5aad310-2561-4fb4-946c-6141d3ecce0b/5bf169fb-7d76-44c1-a47c-9b8a9b0184b7.png)
    
    - 学生と受講が「1対多」、講義と受講が「1対多」となり、多対多の関係が消去される
    
    <aside>
    💡 関連実体を使用して「多対多」から1対多に変換する
    
    </aside>