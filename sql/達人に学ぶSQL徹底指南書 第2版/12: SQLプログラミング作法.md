## テーブル設計

---

### 名前と意味

- 列、テーブル、インデックス、制約は意味がわかる命名を意識する
- 命名に使用できる3種類の文字 (標準SQL)
    - アルファベット
    - 数字
    - アンダーバー
- 英単語を使用するか、ローマ字を使用するか
    - Ex. 学生id
        - student_id
        - gakusei_id
    - 意見が分かれている
        - 開発プロジェクトがグローバルであれば、英語一択。
        - 日本に閉ざしたプロジェクトであれば、ローマ字の方が可読性は高い
    

### 属性と列

- 列はある実体の属性。永続的に変わらないもの
    
    → 列にもたせる意味は変更しない
    

## コーディングの指針

---

### インデント

- サブクエリはインテントを一段下げる
- 句の単位で改行する
- 筆者は末尾を揃えると、次に来る列名やテーブル名の位置が揃って読みやすいので良いと感じている
    
    ```sql
    SELECT
    	FROM
     WHERE
     GROUP BY
    HAVING
     ORDER BY
    ```
    

### 大文字と小文字

- 予約語は大文字、列名やテーブル名は小文字
- SQLでは、大文字・小文字はDBMS内部では同じように扱われる

### 標準語を話そう

- 方言に頼りすぎると、DBMS間のコード移植性が恐ろしく低くなるため
- ポイント
    1. 実装依存の関数・演算子を使わない
        
        Ex. IF(MySQL)、DECODE(Oracle)、NVL(Oracle)
        
    2. 結合には標準の構文を使う
        - 以前はWHERE句に結合条件を書いていた
        
        → INNTERやCROSSなどの結合の種類を表すキーワードを用いる。条件をON句に分離してかく
        

### 相関サブクエリを使用しない

- 前提
    
    [相関サブクエリ](https://www.notion.so/10c577f5217c4d1080b886077241e47d?pvs=21) 
    
- 相関サブクエリよりもウインドウ関数を使用した方が、パフォーマンスも可読性も上がる
    - [ウインドウ関数 vs 相関サブクエリ](https://www.notion.so/vs-c714bfcf9aa14ced8d9e6a55ac446b8e?pvs=21)
- デバッグが難しい
    - サブクエリ単独での実行ができないため

### FROM句から書く

- SQLの実行順序は、下記の通りになる
    - FROM → WHERE → GROUP BY → HAVING  → SELECT (→ ORDER BY)
- 複雑なSQLを書くときは、いきなりSELECT句から書くより、実行順序に沿ってFROM句から書いた方が自然にロジックを追える