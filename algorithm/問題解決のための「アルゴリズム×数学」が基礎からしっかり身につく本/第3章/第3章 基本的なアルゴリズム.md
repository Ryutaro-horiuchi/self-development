# 3.1 素数判定法

## 単純な素数判定法

- 2からN-1までを順に割り切れる数があるかどうかを検証する。
- 線形探索であり、計算量は`*O(N)*`
    - [線形時間](https://www.notion.so/19f93db055548095bb50cceeadd5d3e0?pvs=21)

## 高速な素数判定法

<aside>
💡

2からN-1までをすべて調べる必要はない。√N以下の整数まで調べてわりきれなければ素数と判定できる

</aside>

- 計算量は`O(√N)`

### 背理法を使って証明する

- 背理法とは
    - 事実Fが間違っていると仮定すると、矛盾が起こることを導く
        - Ex.  三角形の内角のうち少なくとも1つは60°以上である
            1. 事実が正しくない、すなわちすべての内角が60°未満と仮定する
            2. この場合、三角形の内角の和は(60°未満) + (60°未満) + (60°未満) = (180°未満)
            3. しかし、三角形の内角の和は必ず180°であるはずだ
            4. したがって「事実が正しくない」と言う仮定は矛盾を生じる
- [高速な素数判定法](https://www.notion.so/1b193db0555480299ab1fa4ce57a4c4e?pvs=21) の証明
    1. Nが合成数であり、1以外で最小のNの約数Aが√Nを超えていると仮定する
    2. 約数の性質により、`A × B = N`とnある正の整数Bが存在する。この時BはNの約数である
    3. しかし、`B = N / A < √N` である。これは2以上の最小の約数がAであることに矛盾する
    4. よって、仮定は成り立たず、この事実は正しい

### 応用例: 約数列挙

素数判定法と似たような次の手順でNの約数を列挙することができる。計算量は`O(√N)`

1.  i = 1,2,3, ..., [√N]について、Nがiで割り切れるかどうかを調べる
2. 割り切れる場合、iとN/iを約数に追加する

- 節末問題
    - 3.1.2 ❌
        - 自然数Nを素因数分解したときに、√Nを超えるものは一つしかない
        - 次のようなアルゴリズムで答えがわかる
            - Nを2で割れるだけ割る
            - Nを3で割れるだけ割る
            - 同じ操作を4,5,…[√N]についても行う
            - 最後に残ったNが1以外の場合、それを素因数に加える
        
        ```python
        N = int(input())
        
        # 素因数分解
        Answer = []
        LIMIT = int(N ** 0.5)
        for i in range(2, LIMIT + 1):
        	while N % i == 0:
        		N /= i
        		Answer.append(i)
        
        if N >= 2:
        	Answer.append(int(N))
        
        # 出力
        print(*Answer)
        ```
        
        - `N ** 0.5`
            
            [べき乗の拡張](https://www.notion.so/19b93db05554802c8671da4bcf134506?pvs=21) 公式2でルートはこの式で算出できる

# 3.2 ユークリッドの互助法
本説では、自然数AとBの最大公約数を求める問題を扱う

## 単純なアルゴリズム

- 33と88の最大公約数を求めるとする
    - 明らかに答えは33以下であるため、「1,2, …, 33」それぞれについて、33と88が割り切れるかどうかを調べる
    - 計算量は`*O(2min(A,B))*`となり、あまり効率的ではない

## ユークリッドの互助法

<aside>
💡

1. 大きいほうの数を「大きいほうを小さいほうで割った余り」に書き換えるという操作を繰り返す
2. 片方が0になったら操作を終了する。もう片方の数が最大公約数である
</aside>

- 計算量は`*O(log(A+B))*`
- イメージ
    
    ![IMG_4287.jpeg](attachment:06bc2f20-fa85-463c-81da-b7161f4550eb:IMG_4287.jpeg)
    

### 3個以上の最大公約数

- 3個以上の数の最大公約数も、ユークリッドの互除法によって計算することができる。
    - まず、1個目の数と2個目の数の最大公約数を計算する
    - 次に、前の計算結果と3個目の数の最大公約数を計算する
    - …
    - 最後に、前の計算結果とN個目の数の最大公約数を計算する

- 節末問題
    - 3.2.1
        
        
        | 3 | 4 | 5 | 6 |
        | --- | --- | --- | --- |
        | 104 | 14 | 14 | 0 |
        | 30 | 30 | 2 | 2 |

# 3.3 場合の数とアルゴリズム
## 基本方式

### ① 積の法則

- 組み合わせの数を掛け算によって求められること
- ex. 朝食
    - 明日の朝食は、おにぎり・食パン・サンドイッチのいずれか
    - 起床時間は5時, 6時, 7時, 8時のいずれか
    - 明日の朝食は3通り、起床時間は4通り。
    - 朝食と起床時間は3 × 4 = 12通り

### ② 積の法則の拡張

- 事柄が3つ以上の場合も組み合わせの数をかけることで求められる
- M通りの選択肢が考えられる事柄がN個あるような組み合わせの数は、
    - M × M × M × … M = Mᴺ 通り

### ③ n個のモノを並び替える方法の数は n! 通り

### ④ n個のモノからr個を並び替える方法は nPr 通り

- Ex. ABCDの中から2人を選び、並び順まで決める方法は₄P₂ = 4 × 3 = 12通り

### ⑤ n個のモノからr個を選ぶ方法はnCr通り

- Ex. ABCDの中から2人を選ぶ方法
    - ₄C₂
        - =  4!  /  2!(4-2)!
        - = 4 × 3 × 2!  /   2! × 2!
        - = 4 × 3 / 2 × 1
        - = 6通り

## 応用例

- ① 買い物の方法の数
    - 問題 写真p83
    - 商品の選び方を全探索する方法だと、*O(N²)*となり効率が悪い
    - 合計の値段が500円となるような買い物の仕方は以下の2通り
        1. 100の品物を1個、400円の品物を2個
        2. 200の品物を1個、300円の品物を2個
    - 100円=a, 200円=b, 300円=c, 400円=dとするとき、積の法則より以下で導き出せる
        - a通り × d通り + b通り × c通り