## サーバーについて

---

- サーバーとは何かサービスを提供するもの
- 「サーバー」には二通りの意味がある
    - 機能としてのサーバー
        - サーバーの機能はソフトウェアで提供される
            
            Ex. ApacheのようなWebサーバーソフトを入れれば、Webサーバーになる
            
    - 物理マシンとしてのサーバー
- 物理的なマシンとしてのサーバーに、複数の「機能としてのサーバー(ソフトウェア)」を同居させることができる
- サーバーの正体は普通のパソコンと変わりはない。普通のパソコンは個人が使うのに対し、サーバーは複数の人がアクセスして使うという違いがあるだけ
- サーバー用OSは、LinuxかUNIX系が採用されることが多い。サーバー用ソフトウェアもLinux用ソフトウェアが多数
    
    → Linux系で有名なもの: Red HatやCentOS、Ubuntu
    

## Docker

---

Dockerとはデータやプログラムを隔離できる仕組み。サーバー上の環境をイナバの物置のような細かい部屋に分ける

### コンテナ(container)とDocker Engine

- 細かい部屋のことをコンテナ。コンテナを使える仕組みがDocker
- Dockerを使うには、Docker Engineをインストールする
    
    → コンテナを作成したり使ったりできるようになる
    

### コンテナはイメージから作る

- イメージ(image)と呼ばれる元々の用意されているイメージから作る
    - Ex. MySQLのコンテナを作りたいのなら、MySQLのイメージを使用する

### DockerにはLinuxOSが必要

- Dockerを使用するにはLinuxOSが必要になる
    
    → コンテナに入れるプログラムもLinux用のプログラムとなっている
    

## なぜデータやプログラムを隔離するのか

---

### 前提

- プログラムは単独で動いているわけではなく、なんらかの実行環境やライブラリ、他のプログラムを使用している
    
    → Ex. Django + MySQL
    
- 複数のシステムが一つのプログラムを使用していたり、共通のディレクトリを参照していることもある

### 本題

- 隔離をしていないと、例えばMySQL5.7と連携しているシステムが二つあるとして、片方のシステムの都合でバージョンを8.0にアップした際に、もう片方のシステムが動かなくなってしまうといったことが起きる
- 共通のソフトウェアに限らず、実行環境やライブラリ、設定ファイルも共有していると上記と同じ問題が起きてくる
- サーバーにプログラムを同居させる場合も、構築時に慎重な検討が必要になる

### プログラムを隔離するということ

- コンテナは他のコンテナから完全に隔離されているため、共通のソフトウェアに依存するシステムがあったとしても、それぞれのシステムとソフトウェアをコンテナ化して隔離してしまえば良い
- 通常の環境であれば、1台のサーバーには一つしか入れられないソフトウェアが多いが、コンテナであれば独立しているため、複数のコンテナに同じプログラムを入れることができる

### コンテナで複数のサーバー機能を安全に同居させる

- 予算の都合で同居させているWebサーバーやメールサーバー、DBサーバーを別々の部屋に分けて安全に運用させることができる
    
    → アップデートしても影響しあうことがない
    
- 1台のサーバーマシンには1つのWebサーバーしか載せられないが、コンテナ技術を使えれば複数のWebサーバーを作って載せることができる
    
    → サーバーマシンの節約にもつながる
    

### コンテナは持ち運べる

- 同じ状態にチューニングしたコンテナを配布することで、一斉に開発環境を整えることができる。開発サーバーで作ったものをそのまま本番サーバーへ持っていくこともできる
- Dockerさえ入っていれば良いため、OSの違いを意識しなくてもコンテナを移動できる

## Dockerと仮想化技術の違い

- 仮想化環境
    - 仮想的に物理的なマシンを用意するようなもの。OSとして当然に何を入れても良い
- コンテナ
    - OSはあるが、あくまでOSっぽいもの。OSの機能のいくつかをホストである物理的なマシンに託すことによって軽くしている。
- EC2
    - 仮想化環境と同じであるが、「インスタンス」機能があり、コンテナと同じくAMIというイメージから作成するため、インスタンスの配布方法が似ている