# 状態遷移テストの概要

- 状態戦隊テストとは、「状態遷移図を用いたテスト」や「状態遷移表を用いたテスト」の総称
- ソフトウェアの動作中に様々に変化する「状態」に着目する
    - 状態遷移とは
        - ある状態が別の状態へ変化すること
    - 状態遷移のきっかけとなる操作や条件のこと
        - イベント

# 状態遷移図と状態遷移表

![IMG_5877.jpeg](attachment:a2d611f2-6e17-4f3a-9882-1afe11b9c4db:IMG_5877.jpeg)

## 画面遷移と状態遷移

- 画面(状態)の洗い出しと、遷移するためのイベントを定義するという観点で、状態遷移テストと変わりはない

## 状態とは

- 概念
    - 一定の同じ動作を続けている様子
    - 動作後に異なる動作を開始しない様子
- 詳しく見ると、3種類
    - 部位の状態
        - ソフトウェアシステムが搭載された機器の部位の状態のこと。「スイッチの状態 ON / OFF」など
    - 処理の状態
        - ソフトウェアにおける処理状態のこと。「計測中」や「データ読み込み中」　など
    - モードの状態
        - ソフトウェアシステムが搭載された機器全体の状態のこと。「ストップウォッチ 計測中 /  処理中 / 停止中」など

## メリット

- 状態遷移図
    - 状態遷移の流れを容易に把握できる
    - 図示することによって新たな発見がある
        - 「どこにも遷移しない状態」や「複数の異なる状態に遷移するイベント」などの不備が見つかる
- 状態遷移表
    - 仕様が曖昧な箇所に潜む欠陥を見つけることができる
    - 状態遷移図の不備を見つけることができる

# 状態遷移図の作り方

- 開発仕様書から「状態」と「イベント」を抽出する
    - ある**「状態」で「イベント」が起きると、別の状態へ「遷移」する**という関係
- 表記方法
    
    ![IMG_5878.jpeg](attachment:87fd3a16-0d02-4b83-880a-3d8f080fb361:IMG_5878.jpeg)
    
- 例
    
    ![IMG_5879.jpeg](attachment:3ac8b448-149a-4418-9f06-6e6cb3930d0b:IMG_5879.jpeg)
    
    - イベントは人の手によるものだけでないことに留意する

## 状態遷移図を見やすくするコツ

- 状態遷移図を機能ごとに分割すると見やすくなる

![IMG_5880.jpeg](attachment:f2e473ca-aa44-4095-b444-f9feac25513b:b240acfc-2aec-4c63-b35f-9766e0b21b33.png)

## 状態遷移図を用いたテスト

- 状態遷移図をもとにテストケースを書いていく。作成する際は、3つのポイントに注目する
    - 全ての状態を1回は通る
    - 全てのイベントを1回は発生させる
    - 全ての遷移を1回は通る

### コピー機の例

- 仕様
    - 状態とイベント
    - 状態遷移図
- テストケース1 「全ての状態を1回は通る」
- テストケース2 「全てのイベントを1回は発生させる」
- テストケース3  「全ての遷移を1回は通る」
- テストケース3が一番多いので優れているように見えるが、テストケース2で定義されていた一部のイベントのケースが含まれていない

<aside>
💡

それぞれの特徴を理解した上で、段階的にそれぞれのテストケースをテストすることが必要

</aside>

### 状態遷移図の目的

- 仕様を図に書き起こすことが状態遷移図を作成する目的ではない
- 作成する際に再度、状態遷移の仕様に漏れや抜けがないかを確認することが大切

### 状態遷移図だけでは不十分

- 状態遷移図は「できること」を表す方法だが、「できないはずのこと」が本当にできないかを確認する必要がある。
    - 状態遷移図は仕様書に書かれていることを図に書き起こすため、「できること」を書いているに過ぎない。そのため、状態遷移図だけでは不十分である