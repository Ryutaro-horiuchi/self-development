サードパーティーなどの外部のソフトウェアとの境界を綺麗に分けるための実践と技法

## サードパーティーとのコードを使用する

---

- サードパーティーのコードを使用する際、提供されるコードをそのまま使用するのではなく、クラスを用いてサードパーティーとの境界を隠すことを推奨
- Ex. [java.util.Map](http://java.util.Map) の境界を隠したクラス
    
    ```java
    public class Sensors {
    	private Map sensors = new HashMap();
    	
    	public Sensor getById(String id) {
    		return (Sensor) sensors.get(id);
    	}
    	
    	...
    }
    ```
    
    - `(Map) sensors.get(id)`は、`getById`メソッド内に定義されており、境界を隠している。
    - 将来的にjava.util.Map自体のAPIがアップデートされ、getメソッドのインターフェースが別のものに変わったとしても、このgetByIdメソッド内のコードを変更するだけになる
        - APIの変更に伴う変更を局所化している
    

## 境界の調査と学習

---

- サードパーティーのコードについて学習しながら、システムに統合することはとても大変な作業
- 学習テストを推奨
    - サードパーティーのAPIを使用して実現したいことを、単体テストに書いていく
    - 実現したいイメージが湧いたところで、システムに統合する

### 学習テストはタダ以上のもの

- 結果的にはコストはかからない
    - どちらにしてもAPIについて、学習が必要だから
- 新バージョンがリリースされたら学習テストを実行してみて、振る舞いにどのような違いがあるかがわかる
- 外部との境界テスト(インターフェイスを製品のコードと同じように使用してみること)を行い、外部との境界を担保するべき。
    - 境界テストは、学習テストが望ましい
    - 将来の移行を簡単に行うことができる。