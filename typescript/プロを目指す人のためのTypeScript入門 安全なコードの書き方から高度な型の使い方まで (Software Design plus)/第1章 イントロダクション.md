## TypeScriptとは

- Microsoftによって開発されている
- AltJSの一種
    - JavaScriptの代替となる言語を指す言葉
- TypeScriptはJavaScriptに静的型付けを追加したプログラミング言語
    - 静的型付けの良い点
        - 型安全性
            - 間違ったプログラムをコンパイラが型チェックにより検出してくれる仕組みのこと。コンパイルエラーは構文エラーと型エラーの2種類が主。
        - ドキュメント化

### TypeScriptコンパイラの役割

1. 型チェック
    - 実際にプログラムを実行しなくても行える静的なものである
    - ランタイムの挙動が型情報に依存しない
        
        → **TypeScriptによって実行の挙動が変わることはない**
        
2. トランスパイル
    - TypeScriptソースコードからJavaScriptソースコードへ変換すること
        - 2つのステップ
            - 型注釈を取り除く
            - 新しい構文から古い構文へ変換
    - コンパイルとトランスパイル
        - トランスパイルをコンパイルと呼ぶこともある
        - ソースコードからCPUが直接解釈可能な機械語に変換するのが最もベーシックなコンパイルだが、あるプログラミング言語から別のプログラミング言語に変換すること全般をコンパイルと呼ぶ立場もある
            
            → 好みの問題
            

### TypeScriptとECMAScriptの関係

- ECMAScriptに追加される機能たちは、**プロポーザル**という単位で管理されており、1から4のステージが与えられている。
- ステージ4は内定でステージ3は完成目前だが、TypeScriptは3の時点でそのプロポーザルの機能をサポートする
    
    → TypeScriptの新規機能を知りたい場合は、ECMAScriptのプロポーザルをウォッチするのが良い
    

### TypeScriptの独自機能は避けるべきか？

- enumやnamespaceが独自機能として挙げられる
- 現在のTypeScriptの方針にそぐわない、かつ独自機能であるゆえに複雑すぎるという意見もあり、筆者も使うべきではないと考えている

## TypeScriptの開発環境

### Node.jsバージョンマネージャー

- 複数のバージョンのNode.jsを同時にインストールして、コマンドで現在使用するバージョンを切り替えることができる
- nvmとvoltaが筆者のおすすめ

### TypeScriptのインストール

- `typescript`と`@types/node`を `—save-dev`オプションでnpm install

### tsconfig.json

- TypeScriptコンパイラに対する設定を記述したファイル
- `$ npx tsc —init` で作成する
    - `npx`: node_modules内にインストールされたコマンドラインプログラムを実行してくれるツール
- 構造
    
    ```json
    {
      "compilerOptions": {
        /* Visit https://aka.ms/tsconfig.json to read more about this file */
    
        /* Projects */
        // "incremental": true,                              /* Enable incremental compilation */
        ...
        "target": "es2016",                                  /* Set the JavaScript language version for emitted JavaScript and include compatible library declarations. */
        // "lib": [],  
        ...
       },
       "include": ["./src/**/*.ts"]
     }
    ```
    
- 本書用に設定を変更
    - compilerOptions配下
        - `"target": "es2020"`
            
            トランスパイルの程度を指定する。es2020は、ES2020以下の構文のみ解釈できる環境でも動作するように、それよりも新しい構文はトランスパイルするという意味
            
        - `"module": "esnext"`
            
            モジュールに関する構文をどう取扱うかを決めるオプション。デフォルトは`commonjs`。`esnext`はES Modulesでの解釈をする
            
        - `"moduleResolution": "node”`
            
            npmでインストールしたモジュールをTypeScriptが認識できるようにするオプション
            
        - `"outDir": "./dist"`
            
            コンパイラによって出力された.jsファイルが出力される先のディレクトリを指定するコンパイラオプション
            
    - `"include": ["./src/**/*.ts"]`
        - srcディレクトリ以下のすべての.tsファイルをコンパイルの対象とする

## 初めてのTypeScriptプログラム

- コンパイルする
    
    `$ npx tsc`
    
    - tscはtsconfing.jsonを自動的に読み込み、それに従ってコンパイルを行う
        
        → outDirで指定したディレクトリ配下にコンパイルされたjsファイルが格納される
        
    - tsファイルを実行するには、コンパイル後に`$ node *.js` を実行の2ステップが必要だが、自動で行ってくれる`ts-node`や`tsc —watch`もおすすめ
        - tscをwatchモードで起動しておくと、.tsファイルが保存されるたびに自動的に再コンパイルを実行してくれる