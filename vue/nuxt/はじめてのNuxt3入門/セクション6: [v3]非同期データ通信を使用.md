## useFetch

- useAsyncDataと$fetchをラップしている
- Nuxtでサーバーからデータを取得する際に使用する
- Ex.
    
    ```tsx
    <template>
      <div>
        <h1>Top Page</h1>
        <hr>
        <p>{{ users[0] }}</p>
      </div>
    </template>
    
    <script setup>
      const { data: users } = await useFetch("https://jsonplaceholder.typicode.com/users")
    </script>
    ```
    

### インターセクター

- fetch呼び出しのライフサイクルイベントフック
    - Ex.
        
        ```tsx
        const { data, status, error, refresh, clear } = await useFetch('/api/auth/login', {
          onRequest ({ request, options }) {
            // リクエストヘッダーを設定する
            options.headers.set('Authorization', '...')
          },
          onRequestError ({ request, options, error }) {
            // リクエストエラーを処理する
          },
          onResponse ({ request, response, options }) {
            // 応答データを処理する
            localStorage.setItem('token', response._data.token)
          },
          onResponseError ({ request, response, options }) {
            //応答エラーを処理する
          },
        })
        ```
        
    - 参考
        
        https://github.com/unjs/ofetch#%EF%B8%8F-interceptors
        

### オプション

- クエリパラメーター
    
    ```tsx
    const param1 = ref('value1')
    const { data, status, error, refresh } = await useFetch('/api/modules', {
      query: { param1, param2: 'value2' },
    })
    ```
    
    上記の例だと、下記のようなURLが生成される
    
    **`https://api.nuxt.com/modules?param1=value1&param2=value2`**。